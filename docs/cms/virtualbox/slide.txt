<style type="text/css">
  .reveal p {
    text-align: justify;
    font-size: 0.8em;
  }
  .reveal ul {
    display: block;
  }
  .reveal ol {
    display: block;
  }
</style>

# 虚拟机

---

## 什么是虚拟机？

虚拟机是指通过软件模拟一套独立运行的硬件环境，用户可以在这个虚拟硬件环境上运行任何系统。虚拟机中运行的系统与物理主机隔离。常见的虚拟机软件包括：

- Hyper-V
- Oracle Virtualbox
- VMWare 系列
- Parallels Desktop (macOS only)

<!-- .element style="font-size: 70%;"-->

--

### 主要用途

在软件测试、信息安全、云计算等多种领域广泛使用。

- 体验各种操作系统环境
- 可重复利用的实验环境
- 为用户提供独立的空间

<!-- .element style="font-size: 70%;"-->

--

### 软件测试角度

虚拟机能够安装多种不同的做系统，构建各种异构的网络环境，帮助测试。

- 多样化网络环境测试
- 多操作系统兼容测试

<!-- .element style="font-size: 70%;"-->

--

### 信息安全角度

虚拟机能够提供隔离、安全的环境来使用危险工具和分析恶意样本，同时也能够构建各种虚拟环境练习渗透技术。

- 恶意代码检测分析
- 单机模拟攻防环境
- 本地操作系统调试

<!-- .element style="font-size: 70%;"-->

--

### 云计算角度

云服务、云计算领域大量采用虚拟化技术为用户提供即开即用的计算资源和服务。

- 基础设施即服务的关键技术
- 独立虚拟主机(VPS)

<!-- .element style="font-size: 70%;"-->

---

## 虚拟机相关概念

--

### 主机操作系统

主机操作系统(Host OS)是指虚拟机软件安装、运行的操作系统环境，比如本课在 Windows 上安装 Virtualbox，那么 Windows 就是主机操作系统。

--

### 客机操作系统

客机操作系统(Guest OS)是指运行虚拟机软件配构建一台虚拟机后，在虚拟机内运行的操作系统，比如可以在 Virtualbox 中新建一台虚拟机安装 Windows，同时新建另一台虚拟机安装 Kali Linux，那么 Windows 和 Kali 都是客机操作系统。

--

### 客机增强件

客机增强件(Guest Additions)是运行在客机操作系统上的一个程序，能够帮助为客机操作系统提供驱动支持，还包含拖放文件、共享粘贴板、自适应显示窗口等高级功能。

---

## Virtualbox 主要配置

由于 Virtualbox 开源免费，本课中实验环境采用 Virtualbox 虚拟机。

- 虚拟 CPU
- 虚拟内存
- 虚拟硬盘
- 虚拟网络

<!-- .element style="font-size: 70%;"-->

--

## 内存与 CPU

根据需求和主机配置来分配，一般不超过 1/2。

--

### 虚拟硬盘

虚拟磁盘实际上在主机操作系统中就是一个特定格式的文件。

- 支持多种硬盘格式: VDI / VHD / VMDK
- 支持多种存放方式: 动态分配 / 固定大小

<!-- .element style="font-size: 70%;"-->

--

### 虚拟网络

Virtualbox 的客机虚拟网络分为以下几种：

|                | NAT | 桥接 | 内部网络 | Host-Only |
| -------------- | --- | ---- | -------- | --------- |
| 客机->主机     | 是  | 是   | 不       | 是        |
| 主机->客机     | 不  | 是   | 不       | 是        |
| 客机->其他主机 | 是  | 是   | 不       | 是        |
| 其他主机->客机 | 不  | 是   | 不       | 不        |
| 客机之间       | 不  | 是   | 同子网   | 是        |

<!-- .element style="font-size: 70%;"-->

---

## 文件传输

--

### 共享文件夹

在主客机之间传输文件，共享文件夹是一种比较方便的办法，需要在主机上配置 Virtualbox:

- 添加 `固定分配` 共享文件夹
- 选择需要共享的文件夹并设置共享名
- 根据需求选择是否`自动挂载`或`只读分配`

<!-- .element style="font-size: 70%;"-->

客机上进行以下配置：

- Windows 下使用`映射网络驱动器功能`并映射路`\\vboxsvr\share_name`
- Linux 下先创建空文件夹如`/mnt/share`，然后 shell 中输入命令:

<!-- .element style="font-size: 70%;"-->

```bash
sudo mount -t vboxsf share_name /mnt/share
```

--

### 其他传输方法

安装客机增强件后还可以采用以下方法实现文件传输：

- 开启拖放功能实现文件拖放
- 开启复制功能实现文件复制
- 使用 U 盘等设备实现文件复制

<!-- .element style="font-size: 70%;"-->

---

## 快照与迁移

--

### 快照

虚拟机在任何状态下都可以暂停或称之为挂起，也可以对当前状态进行快照。对于专业相关实验尤其方便，任何时候都可以通过恢复快照还原系统状态。

- 保存当前客机的系统、文件、运行状态
- 需要时通过恢复快照回到所保存的状态
- 即使虚拟机进行了迁移也能恢复快照
- 删除快照并不会影响虚拟机当前的状态

<!-- .element style="font-size: 70%;"-->

--

### 迁移

如果要分享自己的虚拟机给其他人或者在不同电脑之间移动虚拟机，则可以采用以下方法进行迁移：

- 最简单的迁移方式就是直接复制整个客机文件夹
- 还可以使用导出导入功能在不同虚拟机软件之间迁移

<!-- .element style="font-size: 70%;"-->

---

## Q & A
